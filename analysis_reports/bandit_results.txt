[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.13.7
Working... ---------------------------------------- 100% 0:00:02

Run started:2025-10-28 18:44:43.675059

Test results:
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: resync/api\gateway.py:597:19
596	
597	            rand = random.randint(1, total_weight)
598	            for i, weight in enumerate(cumulative_weights):

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html
   Location: resync/api\gateway.py:733:15
732	        key_string = "|".join(key_parts)
733	        return hashlib.md5(key_string.encode()).hexdigest()
734	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'TOKEN_EXPIRED'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: resync/core\exceptions.py:32:20
31	    INVALID_CREDENTIALS = "INVALID_CREDENTIALS"
32	    TOKEN_EXPIRED = "TOKEN_EXPIRED"
33	    TOKEN_INVALID = "TOKEN_INVALID"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'TOKEN_INVALID'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: resync/core\exceptions.py:33:20
32	    TOKEN_EXPIRED = "TOKEN_EXPIRED"
33	    TOKEN_INVALID = "TOKEN_INVALID"
34	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: resync/core\pools\db_pool.py:120:23
119	                * (2 ** (tries - 1))
120	                * (1 + random.uniform(-0.1, 0.1))
121	            )

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'testpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b107_hardcoded_password_default.html
   Location: resync/services\tws_client_factory.py:246:4
245	    @staticmethod
246	    def create_for_testing(
247	        hostname: str = "localhost",
248	        port: int = 1619,
249	        username: str = "testuser",
250	        password: str = "testpass",
251	    ) -> BaseTWSClient:
252	        """Cria cliente para testes com valores padrÃ’o."""
253	        config = TWSConfig(
254	            hostname=hostname,
255	            port=port,
256	            username=username,
257	            password=password,
258	            mock_mode=True,
259	            timeout=5,  # Timeout menor para testes
260	        )
261	        return TWSClientFactory.create(config)
262	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'TOKEN_EXPIRED'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: resync/utils\exceptions.py:32:20
31	    INVALID_CREDENTIALS = "INVALID_CREDENTIALS"
32	    TOKEN_EXPIRED = "TOKEN_EXPIRED"
33	    TOKEN_INVALID = "TOKEN_INVALID"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'TOKEN_INVALID'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: resync/utils\exceptions.py:33:20
32	    TOKEN_EXPIRED = "TOKEN_EXPIRED"
33	    TOKEN_INVALID = "TOKEN_INVALID"
34	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: resync/utils\test_agent_manager.py:25:29
24	    """
25	    non_existent_path = Path("/tmp/non_existent_config.json")
26	    with pytest.raises(MissingConfigError):

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: resync/utils\test_agent_manager.py:67:13
66	        "resync.settings.AGENT_CONFIG_PATH",
67	        Path("/tmp/non_existent_path.json"),
68	    )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_agent_manager.py:71:4
70	    await agent_manager.load_agents_from_config()
71	    assert agent_manager.agents == {}
72	    assert agent_manager.agent_configs == []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_agent_manager.py:72:4
71	    assert agent_manager.agents == {}
72	    assert agent_manager.agent_configs == []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:44:4
43	    # Assert
44	    assert result is None
45	    assert "Skipping memory test-mem-123 due to LLM failure" in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:45:4
44	    assert result is None
45	    assert "Skipping memory test-mem-123 due to LLM failure" in caplog.text
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:62:4
61	    # Assert
62	    assert result is None
63	    assert "Could not acquire lock for memory test-mem-123" in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:63:4
62	    assert result is None
63	    assert "Could not acquire lock for memory test-mem-123" in caplog.text
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:85:4
84	    # Assert
85	    assert result is None
86	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:86:4
85	    assert result is None
86	    assert (
87	        "Database or KnowledgeGraph error analyzing memory test-mem-123"
88	        in caplog.text
89	    )
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_ia_auditor.py:106:4
105	    # Assert
106	    assert result["error"] == "database_fetch_failed"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_json_parser.py:12:4
11	    expected = {"key1": "value1", "key2": 123}
12	    assert parse_llm_json_response(text, required_keys) == expected
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_json_parser.py:21:4
20	        parse_llm_json_response(text, required_keys)
21	    assert "missing required keys: key2" in str(excinfo.value)
22	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_json_parser.py:30:4
29	        parse_llm_json_response(text, required_keys)
30	    assert "Invalid JSON format" in str(excinfo.value)
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_json_parser.py:39:4
38	        parse_llm_json_response(text, required_keys)
39	    assert "No valid JSON object found" in str(excinfo.value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_llm.py:40:4
39	    # Assertions
40	    assert result == "Mocked LLM Response"
41	    mock_acompletion.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_llm.py:75:4
74	    # Total expected: 3 x 4 = 12 calls
75	    assert mock_factory_call.call_count == 12
76	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_llm.py:109:4
108	    # Total expected: 2 x 4 = 8 calls
109	    assert mock_factory_call.call_count == 8

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_tws_tools.py:44:4
43	
44	    assert "Falha de comunicaÃ¾Ã’o com o TWS" in str(excinfo.value)
45	    assert isinstance(excinfo.value.__cause__, TWSConnectionError)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_tws_tools.py:45:4
44	    assert "Falha de comunicaÃ¾Ã’o com o TWS" in str(excinfo.value)
45	    assert isinstance(excinfo.value.__cause__, TWSConnectionError)
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_tws_tools.py:63:4
62	
63	    assert "Erro ao processar os dados de status do TWS" in str(excinfo.value)
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: resync/utils\test_tws_tools.py:82:4
81	
82	    assert "Ocorreu um erro inesperado ao analisar as falhas do TWS" in str(
83	        excinfo.value
84	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 43666
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 27
		Medium: 2
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 7
		High: 23
Files skipped (0):
