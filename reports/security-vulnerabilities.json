{"dependencies": [{"name": "accelerate", "version": "1.10.1", "vulns": []}, {"name": "agno", "version": "2.0.8", "vulns": []}, {"name": "aiohappyeyeballs", "version": "2.6.1", "vulns": []}, {"name": "aiohttp", "version": "3.12.15", "vulns": []}, {"name": "aiosignal", "version": "1.4.0", "vulns": []}, {"name": "altgraph", "version": "0.17.4", "vulns": []}, {"name": "anaconda-anon-usage", "skip_reason": "Dependency not found on PyPI and could not be audited: anaconda-anon-usage (0.7.2)"}, {"name": "anaconda-auth", "version": "0.8.6", "vulns": []}, {"name": "anaconda-cli-base", "version": "0.5.2", "vulns": []}, {"name": "annotated-types", "version": "0.6.0", "vulns": []}, {"name": "antlr4-python3-runtime", "version": "4.9.3", "vulns": []}, {"name": "anyio", "version": "4.10.0", "vulns": []}, {"name": "apscheduler", "version": "3.11.0", "vulns": []}, {"name": "archspec", "version": "0.2.3", "vulns": []}, {"name": "asgiref", "version": "3.9.1", "vulns": []}, {"name": "astroid", "version": "3.3.11", "vulns": []}, {"name": "attrs", "version": "25.3.0", "vulns": []}, {"name": "authlib", "version": "1.6.3", "vulns": [{"id": "GHSA-9ggr-2464-2j32", "fix_versions": ["1.6.4"], "aliases": ["CVE-2025-59420"], "description": "## Summary Authlib\u2019s JWS verification accepts tokens that declare unknown critical header parameters (`crit`), violating RFC 7515 \u201cmust\u2011understand\u201d semantics. An attacker can craft a signed token with a critical header (for example, `bork` or `cnf`) that strict verifiers reject but Authlib accepts. In mixed\u2011language fleets, this enables split\u2011brain verification and can lead to policy bypass, replay, or privilege escalation.  ## Affected Component and Versions - Library: Authlib (JWS verification) - API: `authlib.jose.JsonWebSignature.deserialize_compact(...)` - Version tested: 1.6.3 - Configuration: Default; no allowlist or special handling for `crit`  ## Details RFC 7515 (JWS) \u00a74.1.11 defines `crit` as a \u201cmust\u2011understand\u201d list: recipients MUST understand and enforce every header parameter listed in `crit`, otherwise they MUST reject the token. Security\u2011sensitive semantics such as token binding (e.g., `cnf` from RFC 7800) are often conveyed via `crit`.  Observed behavior with Authlib 1.6.3: - When a compact JWS contains a protected header with `crit: [\"cnf\"]` and a `cnf` object, or `crit: [\"bork\"]` with an unknown parameter, Authlib verifies the signature and returns the payload without rejecting the token or enforcing semantics of the critical parameter. - By contrast, Java Nimbus JOSE+JWT (9.37.x) and Node `jose` v5 both reject such tokens by default when `crit` lists unknown names.  Impact in heterogeneous fleets: - A strict ingress/gateway (Nimbus/Node) rejects a token, but a lenient Python microservice (Authlib) accepts the same token. This split\u2011brain acceptance bypasses intended security policies and can enable replay or privilege escalation if `crit` carries binding or policy information.  ## Proof of Concept (PoC) This repository provides a multi\u2011runtime PoC demonstrating the issue across Python (Authlib), Node (`jose` v5), and Java (Nimbus).  ### Prerequisites - Python 3.8+ - Node.js 18+ - Java 11+ with Maven  ### Setup  Enter the directory **authlib-crit-bypass-poc** & run following commands. ```bash make setup make tokens ```  ### Tokens minted - `tokens/unknown_crit.jwt` with protected header:   `{ \"alg\": \"HS256\", \"crit\": [\"bork\"], \"bork\": \"x\" }` - `tokens/cnf_header.jwt` with protected header:   `{ \"alg\": \"HS256\", \"crit\": [\"cnf\"], \"cnf\": {\"jkt\": \"thumb-42\"} }`  ### Reproduction Run the cross\u2011runtime demo: ```bash make  demo ```  Expected output for each token (strict verifiers reject; Authlib accepts):  For `tokens/unknown_crit.jwt`: ``` Strict(Nimbus): REJECTED (unknown critical header: bork) Strict(Node jose): REJECTED (unrecognized crit) Lenient(Authlib): ACCEPTED -> payload={'sub': '123', 'role': 'user'} ```  For `tokens/cnf_header.jwt`: ``` Strict(Nimbus): REJECTED (unknown critical header: cnf) Strict(Node jose): REJECTED (unrecognized crit) Lenient(Authlib): ACCEPTED -> payload={'sub': '123', 'role': 'user'} ```  Environment notes: - Authlib version used: `1.6.3` (from PyPI) - Node `jose` version: `^5` - Nimbus JOSE+JWT version: `9.37.x` - HS256 secret is 32 bytes to satisfy strict verifiers: `0123456789abcdef0123456789abcdef`  ## Impact - Class: Violation of JWS `crit` \u201cmust\u2011understand\u201d semantics; specification non\u2011compliance leading to authentication/authorization policy bypass. - Who is impacted: Any service that relies on `crit` to carry mandatory security semantics (e.g., token binding via `cnf`) or operates in a heterogeneous fleet with strict verifiers elsewhere. - Consequences: Split\u2011brain acceptance (gateway rejects while a backend accepts), replay, or privilege escalation if critical semantics are ignored.  ## References - RFC 7515: JSON Web Signature (JWS), \u00a74.1.11 `crit` - RFC 7800: Proof\u2011of\u2011Possession Key Semantics for JWTs (`cnf`)"}]}, {"name": "autoflake", "version": "2.3.1", "vulns": []}, {"name": "backoff", "version": "2.2.1", "vulns": []}, {"name": "bandit", "version": "1.8.6", "vulns": []}, {"name": "bidict", "version": "0.23.1", "vulns": []}, {"name": "black", "version": "25.1.0", "vulns": []}, {"name": "bleach", "version": "6.2.0", "vulns": []}, {"name": "blinker", "version": "1.9.0", "vulns": []}, {"name": "boltons", "version": "25.0.0", "vulns": []}, {"name": "boolean-py", "version": "5.0", "vulns": []}, {"name": "brotlicffi", "version": "1.0.9.2", "vulns": []}, {"name": "cachecontrol", "version": "0.14.3", "vulns": []}, {"name": "cachetools", "version": "6.2.0", "vulns": []}, {"name": "cerebras-cloud-sdk", "version": "1.50.1", "vulns": []}, {"name": "certifi", "version": "2025.8.3", "vulns": []}, {"name": "cffi", "version": "1.17.1", "vulns": []}, {"name": "charset-normalizer", "version": "3.3.2", "vulns": []}, {"name": "click", "version": "8.2.1", "vulns": []}, {"name": "cmake", "version": "4.1.0", "vulns": []}, {"name": "colorama", "version": "0.4.6", "vulns": []}, {"name": "conda", "skip_reason": "Dependency not found on PyPI and could not be audited: conda (25.7.0)"}, {"name": "conda-anaconda-telemetry", "skip_reason": "Dependency not found on PyPI and could not be audited: conda-anaconda-telemetry (0.3.0)"}, {"name": "conda-anaconda-tos", "skip_reason": "Dependency not found on PyPI and could not be audited: conda-anaconda-tos (0.2.2)"}, {"name": "conda-content-trust", "skip_reason": "Dependency not found on PyPI and could not be audited: conda-content-trust (0.2.0)"}, {"name": "conda-libmamba-solver", "skip_reason": "Dependency not found on PyPI and could not be audited: conda-libmamba-solver (25.4.0)"}, {"name": "conda-package-handling", "version": "2.4.0", "vulns": []}, {"name": "conda-package-streaming", "version": "0.12.0", "vulns": []}, {"name": "cryptography", "version": "45.0.5", "vulns": []}, {"name": "cyclonedx-python-lib", "version": "9.1.0", "vulns": []}, {"name": "defusedxml", "version": "0.7.1", "vulns": []}, {"name": "dep-logic", "version": "0.5.2", "vulns": []}, {"name": "deprecated", "version": "1.2.18", "vulns": []}, {"name": "dill", "version": "0.4.0", "vulns": []}, {"name": "diskcache", "version": "5.6.3", "vulns": []}, {"name": "distlib", "version": "0.4.0", "vulns": []}, {"name": "distro", "version": "1.9.0", "vulns": []}, {"name": "docstring-parser", "version": "0.17.0", "vulns": []}, {"name": "dparse", "version": "0.6.4", "vulns": []}, {"name": "duckduckgo-search", "version": "8.1.1", "vulns": []}, {"name": "einops", "version": "0.8.1", "vulns": []}, {"name": "fastapi", "version": "0.116.1", "vulns": []}, {"name": "fastapi-socketio", "version": "0.0.10", "vulns": []}, {"name": "fastuuid", "version": "0.12.0", "vulns": []}, {"name": "filelock", "version": "3.19.1", "vulns": []}, {"name": "findpython", "version": "0.7.0", "vulns": []}, {"name": "flake8", "version": "7.3.0", "vulns": []}, {"name": "flask", "version": "3.1.2", "vulns": []}, {"name": "flask-cors", "version": "6.0.1", "vulns": []}, {"name": "flask-socketio", "version": "5.5.1", "vulns": []}, {"name": "frozendict", "version": "2.4.2", "vulns": []}, {"name": "frozenlist", "version": "1.7.0", "vulns": []}, {"name": "fsspec", "version": "2025.9.0", "vulns": []}, {"name": "gguf", "version": "0.17.1", "vulns": []}, {"name": "gitdb", "version": "4.0.12", "vulns": []}, {"name": "gitpython", "version": "3.1.45", "vulns": []}, {"name": "googleapis-common-protos", "version": "1.70.0", "vulns": []}, {"name": "greenlet", "version": "3.2.4", "vulns": []}, {"name": "grpcio", "version": "1.74.0", "vulns": []}, {"name": "h11", "version": "0.16.0", "vulns": []}, {"name": "h2", "version": "4.3.0", "vulns": []}, {"name": "hishel", "version": "0.1.3", "vulns": []}, {"name": "hpack", "version": "4.1.0", "vulns": []}, {"name": "httpcore", "version": "1.0.9", "vulns": []}, {"name": "httptools", "version": "0.6.4", "vulns": []}, {"name": "httpx", "version": "0.28.1", "vulns": []}, {"name": "huggingface-hub", "version": "0.34.4", "vulns": []}, {"name": "hyperframe", "version": "6.1.0", "vulns": []}, {"name": "id", "version": "1.5.0", "vulns": []}, {"name": "idna", "version": "3.7", "vulns": []}, {"name": "importlib-metadata", "version": "8.7.0", "vulns": []}, {"name": "iniconfig", "version": "2.1.0", "vulns": []}, {"name": "installer", "version": "0.7.0", "vulns": []}, {"name": "isort", "version": "6.0.1", "vulns": []}, {"name": "itsdangerous", "version": "2.2.0", "vulns": []}, {"name": "jaraco-classes", "version": "3.4.0", "vulns": []}, {"name": "jaraco-context", "skip_reason": "Dependency not found on PyPI and could not be audited: jaraco-context (0.0.0)"}, {"name": "jaraco-functools", "version": "4.1.0", "vulns": []}, {"name": "jinja2", "version": "3.1.6", "vulns": []}, {"name": "jiter", "version": "0.10.0", "vulns": []}, {"name": "joblib", "version": "1.5.2", "vulns": []}, {"name": "json-repair", "version": "0.50.1", "vulns": []}, {"name": "jsonpatch", "version": "1.33", "vulns": []}, {"name": "jsonpointer", "version": "3.0.0", "vulns": []}, {"name": "jsonschema", "version": "4.25.1", "vulns": []}, {"name": "jsonschema-specifications", "version": "2025.9.1", "vulns": []}, {"name": "keyring", "version": "25.6.0", "vulns": []}, {"name": "libcst", "version": "1.7.0", "vulns": []}, {"name": "libmambapy", "skip_reason": "Dependency not found on PyPI and could not be audited: libmambapy (2.0.5)"}, {"name": "license-expression", "version": "30.4.4", "vulns": []}, {"name": "limits", "version": "5.5.0", "vulns": []}, {"name": "linkify-it-py", "version": "2.0.3", "vulns": []}, {"name": "litellm", "version": "1.77.1", "vulns": []}, {"name": "llama-cpp-python", "version": "0.3.16", "vulns": []}, {"name": "loguru", "version": "0.7.3", "vulns": []}, {"name": "lxml", "version": "6.0.1", "vulns": []}, {"name": "markdown", "version": "3.9", "vulns": []}, {"name": "markdown-it-py", "version": "2.2.0", "vulns": []}, {"name": "markupsafe", "version": "3.0.2", "vulns": []}, {"name": "marshmallow", "version": "4.0.1", "vulns": []}, {"name": "mccabe", "version": "0.7.0", "vulns": []}, {"name": "mdit-py-plugins", "version": "0.5.0", "vulns": []}, {"name": "mdurl", "version": "0.1.0", "vulns": []}, {"name": "mem0ai", "version": "0.1.117", "vulns": []}, {"name": "memory-profiler", "version": "0.61.0", "vulns": []}, {"name": "menuinst", "skip_reason": "Dependency not found on PyPI and could not be audited: menuinst (2.3.1)"}, {"name": "mistral-common", "version": "1.8.5", "vulns": []}, {"name": "more-itertools", "version": "10.3.0", "vulns": []}, {"name": "mpmath", "version": "1.3.0", "vulns": []}, {"name": "msgpack", "version": "1.1.1", "vulns": []}, {"name": "multidict", "version": "6.6.4", "vulns": []}, {"name": "mutmut", "version": "3.3.1", "vulns": []}, {"name": "mypy", "version": "1.17.1", "vulns": []}, {"name": "mypy-extensions", "version": "1.1.0", "vulns": []}, {"name": "nest-asyncio", "version": "1.6.0", "vulns": []}, {"name": "networkx", "version": "3.5", "vulns": []}, {"name": "nltk", "version": "3.9.1", "vulns": []}, {"name": "numpy", "version": "2.3.3", "vulns": []}, {"name": "omegaconf", "version": "2.3.0", "vulns": []}, {"name": "openai", "version": "1.99.9", "vulns": []}, {"name": "opentelemetry-api", "version": "1.37.0", "vulns": []}, {"name": "opentelemetry-exporter-jaeger-thrift", "version": "1.21.0", "vulns": []}, {"name": "opentelemetry-exporter-otlp-proto-common", "version": "1.37.0", "vulns": []}, {"name": "opentelemetry-exporter-zipkin-json", "version": "1.37.0", "vulns": []}, {"name": "opentelemetry-instrumentation", "version": "0.58b0", "vulns": []}, {"name": "opentelemetry-instrumentation-asgi", "version": "0.58b0", "vulns": []}, {"name": "opentelemetry-instrumentation-fastapi", "version": "0.58b0", "vulns": []}, {"name": "opentelemetry-instrumentation-httpx", "version": "0.58b0", "vulns": []}, {"name": "opentelemetry-proto", "version": "1.37.0", "vulns": []}, {"name": "opentelemetry-sdk", "version": "1.37.0", "vulns": []}, {"name": "opentelemetry-semantic-conventions", "version": "0.58b0", "vulns": []}, {"name": "opentelemetry-util-http", "version": "0.58b0", "vulns": []}, {"name": "orjson", "version": "3.11.3", "vulns": []}, {"name": "packageurl-python", "version": "0.17.5", "vulns": []}, {"name": "packaging", "version": "25.0", "vulns": []}, {"name": "pandas", "version": "2.3.2", "vulns": []}, {"name": "pathspec", "version": "0.12.1", "vulns": []}, {"name": "pbs-installer", "version": "2025.9.2", "vulns": []}, {"name": "pdm", "version": "2.25.9", "vulns": []}, {"name": "pefile", "version": "2023.2.7", "vulns": []}, {"name": "pillow", "version": "11.3.0", "vulns": []}, {"name": "pip", "version": "25.2", "vulns": []}, {"name": "pip-api", "version": "0.0.34", "vulns": []}, {"name": "pip-audit", "version": "2.9.0", "vulns": []}, {"name": "pip-requirements-parser", "version": "32.0.1", "vulns": []}, {"name": "pkce", "version": "1.0.3", "vulns": []}, {"name": "platformdirs", "version": "4.3.7", "vulns": []}, {"name": "pluggy", "version": "1.5.0", "vulns": []}, {"name": "portalocker", "version": "3.2.0", "vulns": []}, {"name": "posthog", "version": "6.7.6", "vulns": []}, {"name": "primp", "version": "0.15.0", "vulns": []}, {"name": "prometheus-client", "version": "0.22.1", "vulns": []}, {"name": "propcache", "version": "0.3.2", "vulns": []}, {"name": "protobuf", "version": "5.29.5", "vulns": []}, {"name": "proxy-api", "skip_reason": "Dependency not found on PyPI and could not be audited: proxy-api (1.0.0)"}, {"name": "proxy-context", "skip_reason": "Dependency not found on PyPI and could not be audited: proxy-context (1.0.0)"}, {"name": "proxy-core", "skip_reason": "Dependency not found on PyPI and could not be audited: proxy-core (1.0.0)"}, {"name": "proxy-logging", "skip_reason": "Dependency not found on PyPI and could not be audited: proxy-logging (1.0.0)"}, {"name": "psutil", "version": "7.0.0", "vulns": []}, {"name": "py-serializable", "version": "2.1.0", "vulns": []}, {"name": "pyasn1", "version": "0.6.1", "vulns": []}, {"name": "pycodestyle", "version": "2.14.0", "vulns": []}, {"name": "pycosat", "version": "0.6.6", "vulns": []}, {"name": "pycountry", "version": "24.6.1", "vulns": []}, {"name": "pycparser", "version": "2.21", "vulns": []}, {"name": "pydantic", "version": "2.9.2", "vulns": []}, {"name": "pydantic-core", "version": "2.23.4", "vulns": []}, {"name": "pydantic-extra-types", "version": "2.10.5", "vulns": []}, {"name": "pydantic-settings", "version": "2.6.1", "vulns": []}, {"name": "pyflakes", "version": "3.4.0", "vulns": []}, {"name": "pygments", "version": "2.19.2", "vulns": []}, {"name": "pyinstaller", "version": "6.15.0", "vulns": []}, {"name": "pyinstaller-hooks-contrib", "version": "2025.8", "vulns": []}, {"name": "pyjwt", "version": "2.10.1", "vulns": []}, {"name": "pylint", "version": "3.3.8", "vulns": []}, {"name": "pyparsing", "version": "3.2.5", "vulns": []}, {"name": "pyproject-hooks", "version": "1.2.0", "vulns": []}, {"name": "pysocks", "version": "1.7.1", "vulns": []}, {"name": "pytest", "version": "8.4.2", "vulns": []}, {"name": "pytest-asyncio", "version": "1.1.0", "vulns": []}, {"name": "python-dateutil", "version": "2.9.0.post0", "vulns": []}, {"name": "python-dotenv", "version": "1.1.0", "vulns": []}, {"name": "python-engineio", "version": "4.12.2", "vulns": []}, {"name": "python-multipart", "version": "0.0.20", "vulns": []}, {"name": "python-socketio", "version": "5.13.0", "vulns": []}, {"name": "pytz", "version": "2025.2", "vulns": []}, {"name": "pywin32", "version": "311", "vulns": []}, {"name": "pywin32-ctypes", "version": "0.2.2", "vulns": []}, {"name": "pyyaml", "version": "6.0.2", "vulns": []}, {"name": "qdrant-client", "version": "1.15.1", "vulns": []}, {"name": "readchar", "version": "4.0.5", "vulns": []}, {"name": "redis", "version": "6.4.0", "vulns": []}, {"name": "referencing", "version": "0.36.2", "vulns": []}, {"name": "regex", "version": "2025.9.1", "vulns": []}, {"name": "requests", "version": "2.32.4", "vulns": []}, {"name": "resolvelib", "version": "1.2.0", "vulns": []}, {"name": "rich", "version": "13.9.4", "vulns": []}, {"name": "rpds-py", "version": "0.27.1", "vulns": []}, {"name": "ruamel-yaml", "version": "0.18.10", "vulns": []}, {"name": "ruamel-yaml-clib", "version": "0.2.12", "vulns": []}, {"name": "ruff", "version": "0.13.0", "vulns": []}, {"name": "safetensors", "version": "0.6.2", "vulns": []}, {"name": "safety", "version": "3.6.1", "vulns": []}, {"name": "safety-schemas", "version": "0.0.14", "vulns": []}, {"name": "scikit-learn", "version": "1.7.2", "vulns": []}, {"name": "scipy", "version": "1.16.1", "vulns": []}, {"name": "semver", "version": "3.0.2", "vulns": []}, {"name": "sentencepiece", "version": "0.2.1", "vulns": []}, {"name": "setproctitle", "version": "1.3.7", "vulns": []}, {"name": "setuptools", "version": "78.1.1", "vulns": []}, {"name": "shellingham", "version": "1.5.0", "vulns": []}, {"name": "simple-websocket", "version": "1.1.0", "vulns": []}, {"name": "six", "version": "1.17.0", "vulns": []}, {"name": "slowapi", "version": "0.1.9", "vulns": []}, {"name": "smmap", "version": "5.0.2", "vulns": []}, {"name": "sniffio", "version": "1.3.1", "vulns": []}, {"name": "socksio", "version": "1.0.0", "vulns": []}, {"name": "sortedcontainers", "version": "2.4.0", "vulns": []}, {"name": "sqlalchemy", "version": "2.0.43", "vulns": []}, {"name": "sqlparse", "version": "0.5.3", "vulns": []}, {"name": "starlette", "version": "0.47.3", "vulns": []}, {"name": "stevedore", "version": "5.5.0", "vulns": []}, {"name": "structlog", "version": "25.4.0", "vulns": []}, {"name": "sympy", "version": "1.14.0", "vulns": []}, {"name": "tenacity", "version": "9.1.2", "vulns": []}, {"name": "textual", "version": "6.1.0", "vulns": []}, {"name": "threadpoolctl", "version": "3.6.0", "vulns": []}, {"name": "thrift", "version": "0.22.0", "vulns": []}, {"name": "tiktoken", "version": "0.11.0", "vulns": []}, {"name": "tokenizers", "version": "0.22.0", "vulns": []}, {"name": "toml", "version": "0.10.2", "vulns": []}, {"name": "tomli", "version": "2.2.1", "vulns": []}, {"name": "tomlkit", "version": "0.13.3", "vulns": []}, {"name": "torch", "version": "2.8.0", "vulns": []}, {"name": "tqdm", "version": "4.67.1", "vulns": []}, {"name": "transformers", "version": "4.56.1", "vulns": []}, {"name": "truststore", "version": "0.10.4", "vulns": []}, {"name": "typer", "version": "0.17.4", "vulns": []}, {"name": "typing-extensions", "version": "4.15.0", "vulns": []}, {"name": "typing-inspection", "version": "0.4.0", "vulns": []}, {"name": "tzdata", "version": "2025.2", "vulns": []}, {"name": "tzlocal", "version": "5.3.1", "vulns": []}, {"name": "uc-micro-py", "version": "1.0.3", "vulns": []}, {"name": "unearth", "version": "0.17.5", "vulns": []}, {"name": "urllib3", "version": "2.5.0", "vulns": []}, {"name": "uvicorn", "version": "0.35.0", "vulns": []}, {"name": "virtualenv", "version": "20.34.0", "vulns": []}, {"name": "watchdog", "version": "6.0.0", "vulns": []}, {"name": "watchfiles", "version": "1.1.0", "vulns": []}, {"name": "webencodings", "version": "0.5.1", "vulns": []}, {"name": "websockets", "version": "15.0.1", "vulns": []}, {"name": "werkzeug", "version": "3.1.3", "vulns": []}, {"name": "wheel", "version": "0.45.1", "vulns": []}, {"name": "win-inet-pton", "version": "1.1.0", "vulns": []}, {"name": "win32-setctime", "version": "1.2.0", "vulns": []}, {"name": "wrapt", "version": "1.17.3", "vulns": []}, {"name": "wsproto", "version": "1.2.0", "vulns": []}, {"name": "yarl", "version": "1.20.1", "vulns": []}, {"name": "z3-solver", "version": "4.15.3.0", "vulns": []}, {"name": "zipp", "version": "3.23.0", "vulns": []}, {"name": "zstandard", "version": "0.23.0", "vulns": []}], "fixes": []}
